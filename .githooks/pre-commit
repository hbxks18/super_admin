#!/bin/bash
# eslintæ£€æŸ¥ï¼Œåªæ£€æŸ¥ä¿®æ”¹çš„æ–‡ä»¶
#
# If you absolutely must commit without testing,
# use: git commit --no-verify

# This will check only staged files to be commited.
list=`git diff --relative --name-only HEAD | grep -e '.jsx\{0,1\}$'`;

if [[ "$list" = "" ]]; then
  exit 0
fi

PASS=true;

for FILE in $list
do
  ./node_modules/.bin/eslint --fix --config=./.pre-commit-eslintrc.json \
  --color "$FILE";

  if [[ "$?" != 0 ]]; then
    echo -e "ESLint æ ¡éªŒå¤±è´¥æ–‡ä»¶ğŸ“: $FILE\n"
    PASS=false
  fi
done



if ! $PASS; then
  echo -e "ğŸ‘´ğŸ¿ è€ä¼™å­ï¼Œä½ çš„æ–‡ä»¶æ²¡æœ‰é€šè¿‡eslintçš„æ ¡éªŒï¼Œæˆ‘æ˜¯ä¸ä¼šè®©ä½ æäº¤çš„ï¼Œå˜¿å˜¿å˜¿~\n"
  exit 1
else
  echo -e "ğŸ‘¶ å°ä¼™å­ï¼Œæœ¬æ¬¡æ”¹åŠ¨æäº¤çš„æ–‡ä»¶é€šè¿‡äº†eslintçš„æ ¡éªŒï¼Œä½ è·å¾—äº†æˆ‘çš„å®ååˆ¶è¡¨æ‰¬ï¼\n"
fi
exit $?

exit $?;

